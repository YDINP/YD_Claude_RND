# ArcaneCollectors 코드베이스 분석 보고서

**분석일**: 2025-02-04
**분석자**: Claude Code
**프로젝트 버전**: v4 (PRD v4 기반)

---

## 1. 프로젝트 개요

| 항목 | 내용 |
|------|------|
| **프로젝트명** | ArcaneCollectors |
| **플랫폼** | Phaser 3 기반 웹 게임 |
| **해상도** | 720x1280 (기본), 1080x1920 (고해상도) |
| **파티 시스템** | 4인 파티 (v3의 5인에서 변경) |
| **전체 구현율** | 약 65-70% |

---

## 2. 디렉토리 구조

```
ArcaneCollectors/
├── src/
│   ├── systems/       (16개 - 핵심 게임 로직)
│   ├── scenes/        (8개 - 게임 씬)
│   ├── components/    (15개 - UI 컴포넌트)
│   ├── data/          (17개 - JSON 데이터)
│   ├── api/           (2개 - 백엔드 API)
│   ├── services/      (6개 - 서비스 레이어)
│   ├── config/        (2개 - 설정)
│   ├── utils/         (5개 - 유틸리티)
│   └── assets/        (프롬프트/리소스)
├── docs/              (문서)
├── n8n/               (자동화 워크플로우)
├── supabase/          (DB 마이그레이션)
└── dist/              (빌드 출력)
```

---

## 3. 구현 현황 상세

### 3.1 완전 구현된 시스템 (✅)

#### EnergySystem.js (292줄)
- 최대 에너지: `100 + (레벨 × 2)`
- 회복 속도: 5분당 1 에너지
- 보석 충전: 50보석 = 50에너지
- 오버플로우: 최대치의 2배까지
- **주요 함수**: `getMaxEnergy()`, `calculateRecovery()`, `consume()`, `refillWithGems()`, `getEnergyStatus()`

#### PersonalitySystem.js (345줄)
- 5가지 성격: Brave, Cunning, Calm, Wild, Mystic
- 상성 시스템: 각 성격이 강점/약점 1개씩
- Mystic 특수: 모든 성격에 +10% 데미지
- **주요 함수**: `calculateDamageMultiplier()`, `calculateBattleDamage()`, `applyPersonalityBonus()`, `analyzePartyPersonalities()`

#### SweepSystem.js (307줄)
- 조건: 별 3개 클리어 완료
- 일일 제한: 50회 (VIP별 증가)
- 배치 소탕: 최대 10회
- **주요 함수**: `canSweep()`, `executeSweep()`, `executeMultiSweep()`, `previewRewards()`

#### SynergySystem.js (455줄)
- 교단 시너지 (2/3/4명)
- 성격 시너지 (4가지 조합)
- 역할 시너지
- 특수 시너지 (특정 캐릭터 조합)
- **주요 함수**: `calculatePartySynergies()`, `calculateCultSynergy()`, `calculatePersonalitySynergies()`

#### PartyManager.js (516줄)
- 4인 파티 구성
- 최대 5개 파티 슬롯
- 중복 영웅 방지
- **주요 함수**: `createParty()`, `saveParty()`, `loadParty()`, `switchActiveParty()`, `validateParty()`

#### SaveManager.js (856줄)
- LocalStorage 저장
- 데이터 압축/복구
- 자동 저장
- **주요 함수**: `saveGame()`, `loadGame()`, `clearSave()`, `exportData()`, `importData()`

---

### 3.2 부분 구현된 시스템 (⚠️)

| 시스템 | 라인 | 구현됨 | 미구현 |
|--------|------|--------|--------|
| **BattleSystem.js** | 1175 | 기본 전투 로직 | 성격 상성 완전 통합, 고급 시너지 |
| **EquipmentSystem.js** | 419 | 장착/해제, 기본 강화 | 81개 장비 데이터, 유물 시스템 |
| **GachaSystem.js** | 343 | 기본 뽑기 로직 | 픽업 기능, 천장 시스템 |
| **EvolutionSystem.js** | 307 | 기본 진화 | 애니메이션, 사운드 |
| **QuestSystem.js** | 457 | 일일 퀘스트 | 이벤트 퀘스트, 자동 지급 |
| **ProgressionSystem.js** | 541 | 레벨업 기본 | 레벨 상한선, 보상 정책 |

---

### 3.3 미구현 시스템 (❌)

#### 백엔드 & Supabase (Critical)
- [ ] Supabase 연동
- [ ] users 테이블
- [ ] player_data 테이블
- [ ] heroes 테이블
- [ ] parties 테이블
- [ ] stage_progress 테이블
- [ ] inventory 테이블
- [ ] API 엔드포인트 (/auth/register, /auth/login 등)

#### 계정 시스템
- [ ] 회원가입
- [ ] 로그인/로그아웃
- [ ] 데이터 동기화
- [ ] 클라우드 저장

#### 고급 기능
- [ ] 레이드 시스템
- [ ] 길드 시스템
- [ ] 타워 시스템
- [ ] 월드 맵
- [ ] 리더보드

---

## 4. 씬(Scene) 구현 현황

| 씬 | 상태 | 설명 |
|----|------|------|
| BootScene.js | ✅ | 게임 초기화, 자산 로드 |
| PreloadScene.js | ✅ | 리소스 사전 로드 |
| MainMenuScene.js | ⚠️ | 메인 메뉴 (일부 기능 미완) |
| StageSelectScene.js | ⚠️ | 스테이지 선택 |
| BattleScene.js | ⚠️ | 실시간 전투 (성격 시스템 부분 연동) |
| GachaScene.js | ⚠️ | 가챠 화면 |
| HeroListScene.js | ⚠️ | 영웅 목록 |
| HeroDetailScene.js | ⚠️ | 영웅 상세 정보 |

---

## 5. 컴포넌트 구현 현황

### 완료 (✅)
- BottomNav.js - 하단 탭 메뉴 (5탭)
- TopBar.js - 상단 플레이어 정보
- HeroCard.js - 영웅 카드 UI
- StatBar.js - 스탯 바
- ProgressBar.js - 진행도 바
- Button.js - 재사용 버튼
- Modal.js - 모달 대화상자
- Panel.js - 패널 레이아웃
- Toast.js - 토스트 알림
- StarRating.js - 별점 표시

### 부분 완료 (⚠️)
- SkillCard.js - 스킬 카드 (성격 효과 미표시)
- SynergyDisplay.js - 시너지 표시 (일부 효과 미표시)
- TurnOrderBar.js - 턴 순서 표시

---

## 6. 데이터 파일 현황

| 파일 | 상태 | 비고 |
|------|------|------|
| personalities.json | ✅ | 5개 성격 완료 |
| synergies.json | ✅ | 시너지 15개+ 조합 |
| cults.json | ✅ | 5개 활성화 교단 |
| characters.json | ⚠️ | 일부 영웅만 |
| stages.json | ⚠️ | 기본 구조만 |
| equipment.json | ⚠️ | 일부 누락 |
| items.json | ⚠️ | 일부 누락 |
| skills.json | ⚠️ | 일부 누락 |
| enemies.json | ⚠️ | 일부 누락 |
| quests.json | ⚠️ | 일부 누락 |

---

## 7. PRD v4 대비 구현율

| 영역 | 구현율 | 상태 |
|------|--------|------|
| 파티 시스템 (5인→4인) | 100% | ✅ |
| 성격 특성 시스템 | 100% | ✅ |
| 시너지 시스템 | 95% | ✅ |
| 에너지 시스템 | 100% | ✅ |
| 소탕 기능 | 100% | ✅ |
| UI/UX 기본 | 80% | ⚠️ |
| 데이터 완성도 | 60% | ⚠️ |
| 백엔드 (Supabase) | 0% | ❌ |
| 계정 시스템 | 0% | ❌ |

---

## 8. 발견된 이슈

### Critical (🔴)
1. **Supabase 백엔드 미구현** - PRD v4 최우선 목표
2. **데이터 불완전** - 81개 장비, 영웅 상세 정보 필요

### High (🟡)
1. 장비 시스템 데이터 부족
2. 영웅 데이터 미완성
3. 진화 애니메이션 없음
4. 가챠 천장 시스템 없음

### Medium (🟢)
1. 퀘스트 이벤트 기능 없음
2. UI 최적화 필요
3. 성능 최적화 필요

---

## 9. 다음 단계 권장사항

### Phase 1: 백엔드 (최우선)
1. Supabase 프로젝트 설정
2. 데이터베이스 테이블 생성
3. API 클라이언트 구현
4. 인증 시스템 구현

### Phase 2: 데이터 완성
1. 81개 장비 데이터
2. 영웅 상세 정보
3. 적 데이터
4. 스테이지 보상

### Phase 3: 기능 완성
1. 진화 애니메이션
2. 가챠 고급 기능
3. 퀘스트 완성
4. 사운드 추가

### Phase 4: 테스트 & 최적화
1. 전체 테스트
2. 성능 최적화
3. UI/UX 버그 수정

---

## 10. 파일별 코드 라인 수

```
시스템 (총 7,442줄):
├── BattleSystem.js      1,175줄 (최대)
├── SaveManager.js         856줄
├── ProgressionSystem.js   541줄
├── PartyManager.js        516줄
├── BattleSystemV2.js      498줄
├── QuestSystem.js         457줄
├── SynergySystem.js       455줄
├── EquipmentSystem.js     419줄
├── DebugManager.js        370줄
├── PersonalitySystem.js   345줄
├── GachaSystem.js         343줄
├── EventBus.js            318줄
├── SweepSystem.js         307줄
├── EvolutionSystem.js     307줄
├── EnergySystem.js        292줄
└── CouponSystem.js        243줄
```

---

*문서 작성 완료: 2025-02-04*
