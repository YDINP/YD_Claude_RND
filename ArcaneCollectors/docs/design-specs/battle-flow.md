# 전투 플로우 디자인 스펙

> **대상 씬**: `BattleScene.js`, `BattleResultScene.js`
> **해상도**: 1080x1920 (9:16 세로형)
> **디자인 시스템**: `DESIGN_SYSTEM.md` 기준

---

## 1. BattleScene 레이아웃

### 1.1 전체 구조

```
┌─────────────────────────────────┐ y=0
│  상단 상태바 (s(60) 높이)         │ depth: 10-11
│  [스테이지명]   [Turn N]   [배속] │
├─────────────────────────────────┤ y=s(60)
│  턴 순서 바 (s(50) 높이)          │ depth: 15
│  [턴 순서: ● ● ● ● ● ● ● ●]    │
├─────────────────────────────────┤ y=s(120)
│                                 │
│  ┌───────┐        ┌───────┐    │
│  │ 아군1  │        │ 적1   │    │ 전투 유닛 영역
│  │ HP/SP │        │ HP/SP │    │ depth: 기본
│  └───────┘        └───────┘    │
│  ┌───────┐        ┌───────┐    │
│  │ 아군2  │        │ 적2   │    │
│  └───────┘        └───────┘    │
│  ┌───────┐        ┌───────┐    │
│  │ 아군3  │        │ 적3   │    │
│  └───────┘        └───────┘    │
│                                 │
│              [시너지 표시]  ──────│ 우측 상단, depth: 12
│                                 │
├─────────────────────────────────┤ y=GAME_HEIGHT-s(160)
│  스킬 카드 영역 (s(60) 높이)       │ depth: 20
│  [카드1][카드2][카드3][카드4]       │
├─────────────────────────────────┤ y=GAME_HEIGHT-s(100)
│  [다음 턴] 버튼 (수동 모드)        │ depth: 21
├─────────────────────────────────┤ y=GAME_HEIGHT-s(50)
│  컨트롤 바 (s(100) 높이)          │ depth: 10-11
│  [AUTO] [1x][2x][3x]    [퇴각]  │
└─────────────────────────────────┘ y=GAME_HEIGHT
```

### 1.2 상단 상태바

| 속성 | 현재값 | 권장값 (DESIGN_SYSTEM 기준) |
|------|--------|--------------------------|
| 배경색 | `COLORS.backgroundLight` | `0x1E293B` (`COLORS.bgLight`) |
| 높이 | `s(60)` | `s(60)` (유지) |
| 스테이지명 폰트 | `sf(16)`, Arial, bold | `sf(16)`, `Noto Sans KR`, bold |
| 스테이지명 색상 | `COLORS.text` | `0xF8FAFC` |
| 턴 텍스트 폰트 | `sf(16)`, Arial | `sf(16)`, `Noto Sans KR` |
| 턴 텍스트 색상 | `COLORS.accent` | `0xF59E0B` |

### 1.3 턴 순서 바

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| Y 위치 | `s(70)` | `s(70)` (유지) |
| 배경색 | `COLORS.backgroundLight` | `0x1E293B` |
| 테두리 | `s(2)`, `COLORS.primary` | `s(2)`, `0x6366F1` |
| 아이콘 (아군) | `COLORS.primary` | `0x6366F1` |
| 아이콘 (적) | `COLORS.danger` | `0xEF4444` |
| 현재 턴 테두리 | `COLORS.accent`, `s(3)` | `0xF59E0B`, `s(3)` |
| 이름 폰트 | `sf(11-14)`, Arial, bold | `sf(11-14)`, `Noto Sans KR`, bold |
| SPD 폰트 | `sf(8)`, Arial | `sf(8)`, `Noto Sans KR` |
| 라벨 폰트 | `sf(12)`, Arial | `sf(12)`, `Noto Sans KR` |

### 1.4 전투 유닛 배치

| 속성 | 아군 | 적 |
|------|------|-----|
| 시작 X | `s(80)` (좌측) | `GAME_WIDTH - s(80)` (우측) |
| 시작 Y | `s(350)` | `s(350)` |
| 간격 | `s(90)` | `s(90)` |
| 스프라이트 스케일 | 0.9 | 0.85 (좌우 반전) |

#### 유닛 스프라이트 구성

| 요소 | 속성 | 값 |
|------|------|-----|
| HP 바 | Y 오프셋 | `s(-55)` |
| HP 바 | 너비 | `s(80)` |
| HP 바 | 높이 | `s(12)` |
| HP 바 | 컴포넌트 | `EnhancedHPBar` (그라데이션, 후행 바, 스킬 게이지) |
| 이름 태그 | Y 오프셋 | `s(45)` |
| 이름 태그 | 폰트 | `sf(11)`, Arial |
| 이름 태그 | 아군 색상 | `COLORS.text` (`0xF8FAFC`) |
| 이름 태그 | 적 색상 | `COLORS.danger` (`0xEF4444`) |
| 보스 라벨 | Y 오프셋 | `s(-60)` |
| 보스 라벨 | 텍스트 | '👑 BOSS' |
| 보스 라벨 | 색상 | `#FFD700` |
| 보스 스케일 | 배율 | x1.3 |

### 1.5 스킬 카드

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 카드 너비 | `s(65)` | `s(70)` |
| 카드 높이 | `s(50)` | `s(55)` |
| 카드 간격 | `s(10)` | `s(10)` |
| 모서리 | 없음 (rectangle) | `s(8)` (둥근 모서리) |
| 비활성 배경 | `COLORS.backgroundLight` 0.7 | `0x1E293B` 0.7 |
| 활성 배경 | `COLORS.secondary` | `0xEC4899` |
| 비활성 테두리 | `s(2)`, `COLORS.primary` | `s(2)`, `0x6366F1` 알파 0.4 |
| 활성 테두리 | `s(2)`, `COLORS.accent` | `s(2)`, `0xF59E0B` |
| 영웅 이름 폰트 | `sf(9)`, Arial, bold | `sf(9)`, `Noto Sans KR`, bold |
| 스킬명 폰트 | `sf(7)`, Arial | `sf(8)`, `Noto Sans KR` |
| 활성 스킬명 색상 | `#FFD700` | `#FFD700` (유지) |
| 비활성 스킬명 색상 | `#999999` | `#94A3B8` (`COLORS.textDark`) |
| 게이지 바 배경 | `0x333333` | `0x374151` (ProgressBar 트랙) |
| 게이지 바 높이 | `s(6)`/`s(4)` | `s(6)` 통일 |
| 게이지 텍스트 폰트 | `sf(8)`, Arial | `sf(8)`, `Noto Sans KR` |

### 1.6 컨트롤 바

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 배경색 | `COLORS.backgroundLight` 0.95 | `0x1E293B` 0.95 |
| 높이 | `s(100)` | `s(100)` (유지) |
| AUTO 버튼 크기 | `s(100)` x `s(40)` | `s(100)` x `s(44)` (최소 터치 영역) |
| AUTO ON 색상 | `COLORS.success` | `0x10B981` |
| AUTO OFF 색상 | `COLORS.backgroundLight` | `0x1E293B` |
| AUTO 테두리 | `s(2)`, `COLORS.primary` | `s(2)`, `0x6366F1` |
| 배속 버튼 크기 | `s(50)` x `s(40)` | `s(50)` x `s(44)` |
| 배속 활성 색상 | `COLORS.primary` | `0x6366F1` |
| 배속 비활성 색상 | `COLORS.backgroundLight` | `0x1E293B` |
| 퇴각 버튼 크기 | `s(100)` x `s(40)` | `s(100)` x `s(44)` |
| 퇴각 버튼 색상 | `COLORS.danger` | `0xEF4444` |
| 버튼 폰트 | Arial | `Noto Sans KR` |
| 버튼 모서리 | 없음 | `s(8)` |

### 1.7 데미지 텍스트

| 데미지 유형 | 폰트 크기 | 색상 | 스트로크 |
|------------|----------|------|---------|
| 일반 (<150) | `sf(18)` | `0xEF4444` (danger) | `s(3)`, 검정 |
| 중간 (150-299) | `sf(22)` | `0xEF4444` | `s(3)`, 검정 |
| 강 (300+) | `sf(26)` | `0xEF4444` | `s(3)`, 검정 |
| 크리티컬 | `sf(32)` | `0xF59E0B` (accent) | `s(5)`, 검정 |
| 크리+유리 | `sf(32)` | `0xFF4500` | `s(5)`, 검정 |
| 유리 상성 | - | `0xFFD700` | - |
| 불리 상성 | - | `0x3498DB` | - |
| 힐 | `sf(22)` | `#4ADE80` | `s(3)`, 검정 |

### 1.8 시너지 표시

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 위치 | `GAME_WIDTH - s(100)`, `s(130)` | 유지 |
| 배경색 | `COLORS.backgroundLight` 0.85 | `0x1E293B` 0.85 |
| 테두리 | `s(1)`, `COLORS.accent` | `s(1)`, `0xF59E0B` |
| 타이틀 폰트 | `sf(10)`, Arial, bold | `sf(10)`, `Noto Sans KR`, bold |
| 시너지 항목 폰트 | `sf(9)`, Arial | `sf(9)`, `Noto Sans KR` |

---

## 2. BattleResultScene 레이아웃

### 2.1 전체 구조

```
승리 레이아웃:
┌─────────────────────────────────┐ y=0
│                                 │
│         'VICTORY'               │ y=s(100), 글로우 애니메이션
│         ★ ★ ★                  │ y=s(180), 순차 등장
│       [스테이지명]               │ y=s(240)
│                                 │
│  ┌─────────────────────────┐    │
│  │        보 상             │    │ y=s(380), 패널
│  │  🪙 +1,234              │    │
│  │  ⭐ +500 EXP            │    │
│  │  📦 아이템               │    │
│  └─────────────────────────┘    │
│                                 │
│  ┌─────────────────────────┐    │
│  │  🎉 레벨 업!             │    │ y=s(580) (있을 때만)
│  │  영웅A  Lv.5 → Lv.6    │    │
│  └─────────────────────────┘    │
│                                 │
│    턴 수: 15턴    생존: 3/4     │ y=s(700)
│                                 │
│    [다음 스테이지]               │ y=s(820)
│    [⚡ 소탕]                     │
│    [재도전]                      │
│    [메인으로]                    │
└─────────────────────────────────┘

패배 레이아웃:
┌─────────────────────────────────┐
│                                 │
│         'DEFEAT'                │ y=s(200)
│          ☆☆☆                  │ y=s(280)
│                                 │
│  "격려 메시지"                   │ y=s(380)
│  [스테이지명]                    │ y=s(460)
│                                 │
│    [재도전]                      │ y=s(580)
│    [파티 편성]                   │
│    [메인으로]                    │
└─────────────────────────────────┘
```

### 2.2 승리 타이틀

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 폰트 | `sf(48)`, Georgia, serif, bold | `sf(48)`, Georgia, serif, bold (유지) |
| 색상 | `#FFD700` | `#FFD700` (유지) |
| 스트로크 | `s(4)`, 검정 | `s(4)`, 검정 (유지) |
| 글로우 애니메이션 | alpha 0.8-1, scale 0.95-1.05 | 유지 |

### 2.3 별점 표시

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 별 크기 | `s(50)` | `s(50)` (유지) |
| 별 간격 | `s(60)` | `s(60)` (유지) |
| 채워진 색상 | `#FFD700` | `#FFD700` (유지) |
| 빈 색상 | `#555555` | `#555555` (유지) |
| 등장 | Back.easeOut, 순차 200ms 딜레이 | 유지 |
| 반짝임 | 채워진 별만, scale 1-1.15 | 유지 |

### 2.4 보상 패널

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 패널 너비 | `s(360)` | `s(380)` |
| 패널 높이 | `s(160)` | `s(170)` |
| 배경색 | `COLORS.bgLight` 0.85 | `0x1E293B` 0.85 |
| 테두리 | `s(2)`, `COLORS.primary` 0.6 | `s(2)`, `0x6366F1` 0.4 |
| 모서리 | 없음 (rectangle) | `s(12)` (둥근 모서리) |
| 타이틀 폰트 | `sf(20)`, Arial, bold | `sf(20)`, `Noto Sans KR`, bold |
| 골드 텍스트 | `sf(22)`, Arial, bold | `sf(22)`, `Noto Sans KR`, bold |
| 골드 색상 | `COLORS.accent` | `0xF59E0B` |
| EXP 텍스트 | `sf(20)`, Arial, bold | `sf(20)`, `Noto Sans KR`, bold |
| EXP 색상 | `COLORS.primary` | `0x6366F1` |
| 아이템 텍스트 | `sf(14)`, Arial | `sf(14)`, `Noto Sans KR` |
| 아이템 색상 | `COLORS.success` | `0x10B981` |

### 2.5 레벨업 배너

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 배경 | `COLORS.success` 0.15 | `0x10B981` 0.15 |
| 테두리 | `s(1)`, `COLORS.success` 0.5 | `s(1)`, `0x10B981` 0.5 |
| 타이틀 | `sf(18)`, bold, success 색상 | 유지 |
| 영웅 텍스트 | `sf(15)`, 일반 | `sf(15)`, `Noto Sans KR` |

### 2.6 전투 통계

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 라벨 폰트 | `sf(13)`, Arial | `sf(13)`, `Noto Sans KR` |
| 라벨 색상 | `COLORS.textDark` | `0x94A3B8` |
| 값 폰트 | `sf(18)`, Arial, bold | `sf(18)`, `Noto Sans KR`, bold |
| 값 색상 | `COLORS.text` | `0xF8FAFC` |

### 2.7 액션 버튼

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 너비 | `s(200)` | `s(220)` |
| 높이 | `s(55)` | `s(55)` (유지, >= 최소 터치 `s(44)`) |
| 간격 | `s(70)` | `s(70)` (유지) |
| 모서리 | 없음 | `s(8)` (둥근 모서리) |
| 테두리 | `s(2)`, 흰색 0.2 | `s(2)`, 흰색 0.2 (유지) |
| 폰트 | `sf(18)`, Arial, bold | `sf(18)`, `Noto Sans KR`, bold |
| hover 효과 | scale 1.05 | alpha 0.85 (DESIGN_SYSTEM 규격) |
| press 효과 | scale 0.95 | scale 0.95 (유지) |

**버튼별 색상**:

| 버튼 | 색상 | 용도 |
|------|------|------|
| 다음 스테이지 | `COLORS.primary` (`0x6366F1`) | 주요 액션 |
| 소탕 | `COLORS.success` (`0x10B981`) | 확인/완료 |
| 재도전 | `COLORS.bgPanel` (`0x334155`) | 보조 액션 |
| 파티 편성 | `COLORS.secondary` (`0xEC4899`) | 보조 강조 |
| 메인으로 | `COLORS.bgPanel` (`0x334155`) | 보조 액션 |

### 2.8 패배 화면

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 타이틀 폰트 | `sf(44)`, Georgia, bold | 유지 |
| 타이틀 색상 | `COLORS.danger` | `0xEF4444` |
| 격려 메시지 폰트 | `sf(16)`, Arial | `sf(16)`, `Noto Sans KR` |
| 격려 메시지 색상 | `COLORS.textDark` | `0x94A3B8` |

### 2.9 소탕 모달

| 속성 | 현재값 | 권장값 |
|------|--------|--------|
| 오버레이 | `0x000000` 0.7 | 유지 (DESIGN_SYSTEM 규격 일치) |
| 패널 너비 | `s(340)` | `s(340)` (유지) |
| 패널 높이 | `s(320)` | `s(320)` (유지) |
| 패널 배경 | `COLORS.bgLight` 0.98 | `0x1E293B` 0.98 |
| 패널 테두리 | `s(2)`, `COLORS.primary` | `s(2)`, `0x6366F1` |
| 패널 모서리 | 없음 | `s(16)` (DESIGN_SYSTEM Modal 규격) |
| 타이틀 | `sf(24)`, bold | `sf(24)`, `Noto Sans KR`, bold |
| 버튼 모서리 | 없음 | `s(8)` |

---

## 3. 애니메이션 규격

### 3.1 전투 시작 인트로

| 유형 | 지속시간 | 이징 | 설명 |
|------|---------|------|------|
| 일반 전투 | 1500ms 총 | - | 검정 오버레이 → 스테이지명 → 페이드 아웃 |
| 보스전 | 2000ms 총 | - | 카메라 쉐이크 → 보스 이름 → 페이드 |

### 3.2 궁극기 컷인

| 단계 | 지속시간 | 효과 |
|------|---------|------|
| 화면 암전 | 200ms / speed | 오버레이 alpha 0→0.7 |
| 초상화 줌인 | 200ms / speed | Back.easeOut, scale 0→1 |
| 이름+스킬명 | 150ms / speed | alpha 0→1 |
| 유지 | 800ms / speed | - |
| 퇴장 | 200ms / speed | alpha 1→0 |

### 3.3 데미지 표시

| 유형 | 등장 | 사라짐 |
|------|------|--------|
| 일반 | 즉시 | 900ms, 위로 s(50), alpha→0 |
| 크리티컬 | scale 2→1.2 (Bounce.easeOut, 200ms) | 900ms, scale 1.5 |
| 힐 | 즉시 | 900ms, 위로 s(40), alpha→0 |

### 3.4 사망 애니메이션

| 단계 | 효과 |
|------|------|
| 파편 | 6개 원형, 랜덤 위치, 600ms 흩어짐 |
| 본체 | alpha→0, y +s(20), 500ms |

---

## 4. 수정 사항 요약

### 4.1 폰트 통일
- 모든 `'Arial'` → `'Noto Sans KR'` 변경

### 4.2 색상 통일
- 하드코딩 배경색 → `COLORS` 상수 사용
- 스킬 카드 게이지 배경 `0x333333` → `0x374151`
- 비활성 스킬명 `#999999` → `#94A3B8`

### 4.3 모서리 추가
- 스킬 카드: `s(8)` 라운딩 (Phaser Graphics 기반)
- 버튼: `s(8)` 라운딩
- 보상 패널: `s(12)` 라운딩

### 4.4 인터랙션 규격 적용
- 버튼 hover: `alpha 0.85` (기존 scale 1.05 대체)
- 버튼 press: `scale 0.95` (유지)

### 4.5 최소 터치 영역
- 컨트롤 바 버튼 높이: `s(40)` → `s(44)` (최소 66px)
